import{r as n,j as e,a as P,u as R,F as T,f as pe,L as I,b as se,c as ae,d as re,e as te,g as ne,h as fe,i as xe,k as je,l as oe,m as be,n as ie,o as ge,p as ve,O as le,q as ce,s as K,t as Ne,v as we,w as ye,x as Ee,y as G,z as Ce,N as de,B as Se,R as ke,A as U,C as ze}from"./vendor-C6fDhUMH.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))d(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&d(i)}).observe(document,{childList:!0,subtree:!0});function c(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function d(l){if(l.ep)return;l.ep=!0;const o=c(l);fetch(l.href,o)}})();const me=n.createContext(),Ae=({children:s})=>{const[a,c]=n.useState([]),d=async()=>{try{const r=await P.get("https://backend-mywf.onrender.com/api/festividad/festividades");c(r.data)}catch(t){console.error("❌ Error al listar los eventos:",t),setTimeout(()=>d(),5e3)}},l=async t=>{try{const r=`https://backend-mywf.onrender.com/api/festividad/detalle/${t}`;return(await P.get(r)).data}catch(r){throw console.error("❌ Error al obtener detalle del evento:",r),r}},o=async t=>{try{const r=localStorage.getItem("token"),u="https://backend-mywf.onrender.com/api/festividad/crear",N={headers:{Authorization:`Bearer ${r}`}};return(await P.post(u,t,N)).data}catch(r){throw console.error("❌ Error al crear el evento:",r),r}},i=async(t,r)=>{try{const u=localStorage.getItem("token"),N=`https://backend-mywf.onrender.com/api/festividad/actualizar/${t}`,v={headers:{Authorization:`Bearer ${u}`}};return(await P.put(N,r,v)).data}catch(u){throw console.error("❌ Error al actualizar el evento:",u),u}},j=async t=>{try{const r=localStorage.getItem("token"),u=`https://backend-mywf.onrender.com/api/festividad/eliminar/${t}`,N={headers:{Authorization:`Bearer ${r}`}};return(await P.delete(u,N)).data}catch(r){throw console.error("❌ Error al eliminar el evento:",r),r}},m=async t=>{try{const r=`https://backend-mywf.onrender.com/api/festividad/festividades-por-mes/${t}`;return(await P.get(r)).data}catch(r){throw console.error("❌ Error al listar eventos por mes:",r),r}};return n.useEffect(()=>{d()},[]),e.jsx(me.Provider,{value:{eventos:a,listarEventos:d,obtenerDetalleEvento:l,crearEvento:o,actualizarEvento:i,eliminarEvento:j,listarEventosPorMes:m},children:s})},qe=({toggleSidebar:s})=>{const[a,c]=n.useState(!1),[d,l]=n.useState(null),[o,i]=n.useState(!1),[j,m]=n.useState(null),[t,r]=n.useState([]),{listarEventosPorMes:u}=n.useContext(me),N=R();n.useEffect(()=>{const p=localStorage.getItem("token"),E=localStorage.getItem("tipoUsuario");c(!!p),l(E)},[]);const v=()=>{localStorage.removeItem("token"),localStorage.removeItem("tipoUsuario"),c(!1),l(null),N("/"),window.location.reload()},b=async p=>{m(p);try{const E=await u(p);r(E[p]||[])}catch(E){console.error("Error al obtener festividades del mes:",E)}},g=()=>{m(null),r([])},x=()=>{i(!o)},h=p=>{N(`/searches?month=${p}`)},f=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];return e.jsxs("nav",{className:"navbar px-4",children:[e.jsx("button",{className:"menu-btn",onClick:s,children:e.jsx(T,{icon:pe})}),e.jsxs(I,{to:"/",className:"navbar-logo",children:[e.jsx("img",{src:"/logo.png",alt:"Logo"}),e.jsx("span",{className:"navbar-title",children:"Megadisfraz"})]}),e.jsx("ul",{className:"navbar-meses",children:f.map(p=>e.jsxs("li",{className:"nav-item",onMouseEnter:()=>b(p),onMouseLeave:g,children:[e.jsx("button",{className:"month-link",onClick:()=>h(p),children:p}),j===p&&t.length>0&&e.jsxs("div",{className:"event-dropdown",children:[e.jsx("div",{className:"event-dropdown-header",children:e.jsxs("h4",{children:["Eventos en ",p]})}),e.jsx("ul",{className:"event-list",children:t.map(E=>e.jsxs("li",{className:"event-item",onClick:()=>N(`/searches?event=${encodeURIComponent(E.nombre)}`),children:[e.jsx("span",{className:"event-day",children:E.dia}),e.jsxs("div",{children:[e.jsx("div",{className:"event-name",children:E.nombre}),E.descripcion&&e.jsx("div",{className:"event-desc",children:E.descripcion})]})]},E.id))})]})]},p))}),e.jsx("div",{className:"navbar-auth",children:a?e.jsxs(e.Fragment,{children:[e.jsx(I,{to:"/perfil",className:"icon-btn profile-icon",title:"Perfil",children:e.jsx(T,{icon:ae})}),e.jsx("button",{className:"icon-btn logout-icon",onClick:v,title:"Cerrar Sesión",children:e.jsx(T,{icon:re})}),(d==="admin"||d==="moderador")&&e.jsxs("div",{className:"admin-menu-container",children:[e.jsxs("button",{className:"icon-btn admin-icon",onClick:x,title:"Administrador",children:[e.jsx(T,{icon:te})," ",e.jsx(T,{icon:ne})]}),o&&e.jsxs("div",{className:"admin-menu",children:[d==="admin"&&e.jsx(I,{to:"/administradores",className:"admin-menu-item",children:"Administradores"}),e.jsx(I,{to:"/eventos",className:"admin-menu-item",children:"Eventos"}),e.jsx(I,{to:"/disfraces",className:"admin-menu-item",children:"Disfraces"}),e.jsx(I,{to:"/etiquetas",className:"admin-menu-item",children:"Etiquetas"})]})]})]}):e.jsx(I,{to:"/login",className:"icon-btn login-icon",title:"Iniciar Sesión",children:e.jsx(T,{icon:se})})})]})},_=n.createContext(),De=({children:s})=>{const[a,c]=n.useState([]),d=async()=>{try{const r=await P.get("https://backend-mywf.onrender.com/api/disfraz/listar");c(r.data)}catch(t){console.error("❌ Error al listar los disfraces:",t),setTimeout(()=>d(),5e3)}},l=async t=>{try{const r=`https://backend-mywf.onrender.com/api/disfraz/detalle/${t}`;return(await P.get(r)).data}catch(r){throw console.error("❌ Error al obtener detalle del disfraz:",r),r}},o=async t=>{try{const r=localStorage.getItem("token"),u="https://backend-mywf.onrender.com/api/disfraz/registro",N={headers:{Authorization:`Bearer ${r}`}};return(await P.post(u,t,N)).data}catch(r){throw console.error("❌ Error al registrar disfraz:",r),r}},i=async(t,r)=>{try{const u=localStorage.getItem("token"),N=`https://backend-mywf.onrender.com/api/disfraz/actualizar/${t}`,v={headers:{Authorization:`Bearer ${u}`}};return(await P.put(N,r,v)).data}catch(u){throw console.error("❌ Error al actualizar el disfraz:",u),u}},j=async t=>{try{const r=localStorage.getItem("token"),u=`https://backend-mywf.onrender.com/api/disfraz/eliminar/${t}`,N={headers:{Authorization:`Bearer ${r}`}};return(await P.delete(u,N)).data}catch(r){throw console.error("❌ Error al eliminar el disfraz:",r),r}},m=t=>a.filter(r=>r.categoria===t);return n.useEffect(()=>{d()},[]),e.jsx(_.Provider,{value:{disfraces:a,setDisfraces:c,listarDisfraces:d,obtenerDetalleDisfraz:l,registrarDisfraz:o,actualizarDisfraz:i,eliminarDisfraz:j,filtrarDisfracesPorCategoria:m},children:s})},$e="/assets/localYaruki1-D10HE0EN.jpg",Fe="/assets/localYaruki2-xWW1MeEk.jpg",Ie="/assets/localCayambe-BEwHE01a.jpg",Q=[{label:"1ra Sucursal: YARUQUI CENTRO",src:"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d249.3626477649494!2d-78.31752496658034!3d-0.16204089881778425!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x91d593004a7fa75f%3A0x5eea80851419080a!2sMegadisfraz!5e0!3m2!1ses-419!2sec!4v1740273750468!5m2!1ses-419!2sec",image:$e},{label:"2da Sucursal: CAYAMBE CENTRO",src:"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d296.54494697342307!2d-78.14407258761588!3d0.04045211760451157!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8e2a08f745888e7b%3A0x836a42c1eea0bfb1!2sCentro%20Comercial%20de%20Vendedores%20Aut%C3%B3nomos!5e0!3m2!1ses-419!2sec!4v1740273826714!5m2!1ses-419!2sec",image:Ie},{label:"3ra Sucursal: YARUQUI - UPC",src:"https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d249.36266087396976!2d-78.3181939994935!3d-0.16097235436319585!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1ses-419!2sec",image:Fe}];function ue(){const[s,a]=n.useState(Q[0].src),[c,d]=n.useState(Q[0]);return e.jsxs("div",{className:"mapa-wrapper",children:[e.jsx("h2",{className:"sidebar-title",children:"Mapa Sucursales"}),e.jsxs("div",{className:"mapa-layout",children:[e.jsx("ul",{className:"sucursales-list",children:Q.map((l,o)=>e.jsx("li",{onClick:()=>d(l),children:l.label},o))}),e.jsx("div",{className:"map-container",children:e.jsx("iframe",{title:"mapa-sucursales",src:c.src,width:"100%",height:"200",style:{border:0},allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade"})}),e.jsx("div",{className:"local-image",children:e.jsx("img",{src:c.image,alt:`Local de ${c.label}`})})]}),e.jsxs("div",{className:"social-icons",children:[e.jsx("a",{href:"https://www.instagram.com/megadisfraz_yaruqui?igsh=dHJwd3hmaHU2aTNq",children:e.jsx(fe,{})}),e.jsx("a",{href:"https://x.com/Megadisfraz?t=IxW60maTBR2FoOO_RNDDeQ&s=09",children:e.jsx(xe,{})}),e.jsx("a",{href:"https://www.tiktok.com/@megadisfraz_yaruqui?_t=ZM-8wGmbrvw46Y&_r=1",children:e.jsx(je,{})}),e.jsx("a",{href:"https://wa.me/593939232766",children:e.jsx(oe,{})}),e.jsx("a",{href:"webmegadisfraz513@gmail.com",children:e.jsx(be,{})})]}),e.jsx("p",{className:"footer-text",children:"© 2025 Megadisfraz"})]})}const Me=({sidebarOpen:s,toggleSidebar:a})=>{const[c,d]=n.useState([]),[l,o]=n.useState(""),[i,j]=n.useState(!1),m=R(),t=ie(),{disfraces:r}=n.useContext(_),u=localStorage.getItem("tipoUsuario"),N=()=>{j(g=>!g)};n.useEffect(()=>{(async()=>{try{const x=await fetch("https://backend-mywf.onrender.com/api/etiqueta/listar",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!x.ok)throw new Error("Error al obtener las etiquetas");const h=await x.json();d(h)}catch(x){console.error("Error al cargar las etiquetas:",x)}})()},[]);const v=g=>{const x=new URLSearchParams(t.search);x.set("etiqueta",g),m(`/searches?${x.toString()}`),a()},b=()=>{l.trim()&&r.filter(x=>x.nombre.toLowerCase().includes(l.toLowerCase())||x.descripcion.toLowerCase().includes(l.toLowerCase())).length>0&&(m(`/searches?query=${l}`),a())};return n.useEffect(()=>(s?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open"),()=>document.body.classList.remove("sidebar-open")),[s]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`overlay ${s?"active":""}`,onClick:a}),e.jsxs("aside",{className:`sidebar ${s?"active":""}`,children:[e.jsxs("div",{className:"sidebar-top",children:[e.jsx("button",{className:"close-btn",onClick:a,children:e.jsx(T,{icon:ge})}),e.jsx("div",{className:"sidebar-auth-icons",children:localStorage.getItem("token")?e.jsxs("div",{className:"auth-icons-wrapper",children:[e.jsx(I,{to:"/perfil",className:"icon-btn profile-icon",title:"Perfil",children:e.jsx(T,{icon:ae})}),e.jsx("button",{className:"icon-btn logout-icon",title:"Cerrar Sesión",onClick:()=>{localStorage.clear(),window.location.reload()},children:e.jsx(T,{icon:re})}),(u==="admin"||u==="moderador")&&e.jsxs("div",{className:"admin-menu-container",children:[e.jsxs("button",{className:"icon-btn admin-icon",onClick:N,title:"Administrador",children:[e.jsx(T,{icon:te})," ",e.jsx(T,{icon:ne})]}),i&&e.jsxs("div",{className:"admin-menu",children:[u==="admin"&&e.jsx(I,{to:"/administradores",className:"admin-menu-item",children:"Administradores"}),e.jsx(I,{to:"/eventos",className:"admin-menu-item",children:"Eventos"}),e.jsx(I,{to:"/disfraces",className:"admin-menu-item",children:"Disfraces"}),e.jsx(I,{to:"/etiquetas",className:"admin-menu-item",children:"Etiquetas"})]})]})]}):e.jsx(I,{to:"/login",className:"icon-btn login-icon",title:"Iniciar Sesión",children:e.jsx(T,{icon:se})})})]}),e.jsxs("div",{className:"search-container",children:[e.jsx("input",{type:"text",placeholder:"Buscar",value:l,onChange:g=>o(g.target.value),onKeyDown:g=>{g.key==="Enter"&&(g.preventDefault(),b())},className:"search-input"}),e.jsx("button",{className:"search-btn",onClick:b,children:e.jsx(T,{icon:ve})})]}),e.jsx("h2",{className:"sidebar-title",children:"Etiquetas"}),e.jsx("div",{className:"tags-container",children:c.map(g=>e.jsx("button",{className:"tag-button",onClick:()=>v(g.nombre),children:g.nombre},g.id))})]})]})},Pe=()=>e.jsxs("footer",{className:"footer",children:[e.jsxs("ul",{className:"footer-links",children:[e.jsx("li",{children:e.jsxs("a",{href:"https://wa.me/593939232766",children:[e.jsx(oe,{}),"Whatsapp."]})}),e.jsx("li",{children:e.jsx("a",{href:"webmegadisfraz513@gmail.com",children:"Gmail."})})]}),e.jsx("p",{className:"footer-text",children:"© 2025 Megadisfraz"})]}),Le=()=>{const[s,a]=n.useState(!1),c=()=>{a(!s)};return e.jsxs("div",{className:"parent",children:[e.jsxs("div",{className:"div1",children:[" ",e.jsx(qe,{toggleSidebar:c})]}),e.jsx(Me,{sidebarOpen:s,toggleSidebar:c}),e.jsxs("div",{className:"div3",children:[e.jsx(le,{})," "]}),e.jsxs("div",{className:"div4",children:[" ",e.jsx(Pe,{})]})]})},he=n.createContext(),Ue=({children:s})=>{const[a,c]=n.useState({}),d=async i=>{try{const m="https://backend-mywf.onrender.com/api",t=localStorage.getItem("tipoUsuario");if(!t)throw new Error("Tipo de usuario no definido");const r=`${m}/admin/perfil`,u={headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`}},N=await P.get(r,u);return c({usuario:N.data,rol:t}),N.data}catch(m){throw console.error("❌ Error al obtener el perfil:",m),m}},l=async(i,j)=>{try{const m=localStorage.getItem("token"),r=localStorage.getItem("tipoUsuario")==="admin"?`https://backend-mywf.onrender.com/api/admin/actualizar/${i}`:`https://backend-mywf.onrender.com/api/usuario/actualizar/${i}`,u={headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`}},N=await P.put(r,j,u);return c(N.data),N.data}catch(m){throw console.error("❌ Error al actualizar el perfil:",m),m}},o=async i=>{try{const j=localStorage.getItem("token"),t=localStorage.getItem("tipoUsuario")==="admin"?"https://backend-mywf.onrender.com/api/admin/actualizar-password":"https://backend-mywf.onrender.com/api/usuario/actualizar-password",r={headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`}};return(await P.put(t,i,r)).data}catch(j){throw console.error("❌ Error al actualizar la contraseña:",j),j}};return n.useEffect(()=>{const i=localStorage.getItem("token");i&&d(i)},[]),e.jsx(he.Provider,{value:{auth:a,setAuth:c,obtenerPerfil:d,actualizarPerfil:l,actualizarPassword:o},children:s})};function Z({className:s,children:a,...c}){return e.jsx("div",{className:ce("bg-white rounded-xl shadow-lg overflow-hidden h-full transform transition-transform hover:scale-105",s),style:{border:"1px solid #ccc",boxShadow:"0 4px 8px rgba(10, 10, 10, 0.78)",transition:"transform 0.3s ease"},...c,children:a})}function X({className:s,children:a,...c}){return e.jsx("div",{className:ce("p-4 h-full",s),...c,children:a})}function V(s){if(typeof s=="string")try{const a=JSON.parse(s);return Array.isArray(a)?a:[]}catch(a){return console.warn("normalizeImages: error al parsear",a),[]}return Array.isArray(s)?s:[]}function O({imagenes:s,index:a=0,alt:c="",className:d="",style:l={},placeholder:o="/placeholder-image.jpg",loading:i="lazy",...j}){const m=V(s),[t,r]=n.useState(m[a]||o);return e.jsx("img",{src:t,alt:c,className:d,style:l,loading:i,onError:()=>r(o),...j})}function Te(){const s=R(),{disfraces:a=[]}=n.useContext(_),c=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],d=c[new Date().getMonth()],l=t=>{const r=[...c],u=r.indexOf(d),N=[...r.slice(u),...r.slice(0,u)].reverse();return[...t].sort((v,b)=>{if(!v.festividades||!b.festividades)return 0;const g=x=>{let h=-1;return x.festividades.forEach(f=>{const p=N.indexOf(f.mes);p>h&&(h=p)}),h};return g(b)-g(v)})},o=t=>[...t].sort((r,u)=>{if(!r.festividades||!u.festividades)return 0;const N=v=>{const b=v.festividades.filter(g=>g.mes===d);return b.length?Math.min(...b.map(g=>g.dia)):1/0};return N(r)-N(u)}),i=a.length?o(a.filter(t=>{var r;return(r=t.festividades)==null?void 0:r.some(u=>u.mes===d)})):[],j=l(a),m=t=>{s(`/productos/${t.id}`)};return e.jsxs("div",{className:"store-container",children:[e.jsx("section",{className:"carousel-section",style:{maxWidth:"90%",margin:"auto"},children:e.jsxs("div",{id:"carouselExampleCaptions",className:"carousel slide w-100 ","data-bs-ride":"carousel",children:[e.jsx("div",{className:"carousel-indicators",children:a.map((t,r)=>e.jsx("button",{type:"button","data-bs-target":"#carouselExampleCaptions","data-bs-slide-to":r,className:r===0?"active":"","aria-current":r===0?"true":"false","aria-label":`Slide ${r+1}`},r))}),e.jsx("div",{className:"carousel-inner",children:a.map((t,r)=>e.jsxs("div",{className:`carousel-item ${r===0?"active":""}`,onClick:()=>m(t),style:{cursor:"pointer"},children:[e.jsx(O,{imagenes:t.imagenes,alt:t.nombre,className:"d-block w-100",style:{height:"500px",objectFit:"cover"}}),e.jsx("div",{className:"carousel-caption d-none d-md-block",children:e.jsx("h5",{children:t.nombre})})]},t.id))}),e.jsxs("button",{className:"carousel-control-prev",type:"button","data-bs-target":"#carouselExampleCaptions","data-bs-slide":"prev",children:[e.jsx("span",{className:"carousel-control-prev-icon","aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:"Previous"})]}),e.jsxs("button",{className:"carousel-control-next",type:"button","data-bs-target":"#carouselExampleCaptions","data-bs-slide":"next",children:[e.jsx("span",{className:"carousel-control-next-icon","aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:"Next"})]})]})}),e.jsxs("section",{className:"new-arrivals",children:[e.jsxs("h2",{className:"titulo",children:["Disfraces de ",d]}),e.jsx("div",{className:"new-arrivals-container",children:i.length?i.map(t=>e.jsxs(Z,{className:"new-arrival-card",onClick:()=>m(t),children:[e.jsx(O,{imagenes:t.imagenes,alt:t.nombre,className:"arrival-image"}),e.jsx(X,{children:e.jsx("p",{children:t.nombre})})]},t.id)):e.jsxs("p",{className:"no-disfraces",children:["No hay disfraces disponibles para ",d,"."]})})]}),e.jsx(ue,{}),e.jsxs("section",{className:"all-disfraces",children:[e.jsx("h2",{className:"all-title",children:"Todos los Disfraces"}),e.jsx("div",{className:"all-container",children:j.length?j.map(t=>{var r;return(r=t.festividades)==null||r.reduce((u,N)=>{const v=c.indexOf(u.mes);return c.indexOf(N.mes)>v?N:u},{mes:"Enero",dia:1}),e.jsxs(Z,{className:"all-card",onClick:()=>m(t),children:[e.jsx(O,{imagenes:t.imagenes,alt:t.nombre,className:"all-image"}),e.jsx(X,{children:e.jsx("p",{children:t.nombre})})]},t.id)}):e.jsx("p",{className:"no-disfraces",children:"Cargando disfraces..."})})]})]})}const Be=()=>{var S,$;const{obtenerDetalleDisfraz:s,disfraces:a}=n.useContext(_),{id:c}=K(),d=R(),[l,o]=n.useState(null),[i,j]=n.useState(null),[m,t]=n.useState(!0),[r,u]=n.useState(null),N=C=>`${C.nombre} - ${C.dia} de ${C.mes}`,v=C=>{const A=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];return[...C].sort((M,F)=>{const B=A.indexOf(M.mes),H=A.indexOf(F.mes);return B!==H?B-H:M.dia-F.dia})};if(n.useEffect(()=>{(async()=>{var C;try{t(!0);const A=await s(c);(C=A==null?void 0:A.festividades)!=null&&C.length&&(A.festividades=v(A.festividades)),j(A||null)}catch{u("Error al cargar los detalles del producto")}finally{t(!1)}})()},[c,s]),m)return e.jsx("div",{className:"loading-message",children:"Cargando detalles del producto..."});if(r)return e.jsx("div",{className:"error-message",children:r});if(!i)return e.jsx("div",{className:"producto-no-encontrado",children:"Producto no encontrado"});const b=V(i.imagenes),g=Number(c),x=a.filter(C=>Number(C.id)!==g),h=C=>Number(C.id),f=7,p=i.nombre.toLowerCase().split(" ").filter(C=>C.length>2),E=x.filter(C=>p.some(A=>{var M;return(M=C.nombre)==null?void 0:M.toLowerCase().includes(A)})).slice(0,f),q=new Set(E.map(h)),L=x.filter(C=>{var A;return!q.has(h(C))&&((A=C.etiquetas)==null?void 0:A.some(M=>{var F;return(F=i.etiquetas)==null?void 0:F.some(B=>B.id===M.id)}))}).slice(0,f),y=new Set(L.map(h)),w=x.filter(C=>{var A;return!q.has(h(C))&&!y.has(h(C))&&((A=C.festividades)==null?void 0:A.some(M=>{var F;return(F=i.festividades)==null?void 0:F.some(B=>M.nombre===B.nombre&&M.dia===B.dia&&M.mes===B.mes)}))}).slice(0,f),k=new Set(w.map(h)),D=x.filter(C=>{var A;return!q.has(h(C))&&!y.has(h(C))&&!k.has(h(C))&&((A=C.festividades)==null?void 0:A.some(M=>{var F;return(F=i.festividades)==null?void 0:F.some(B=>M.mes===B.mes)}))}).slice(0,f),z=(C,A)=>A.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"titulo",children:C}),e.jsx("div",{className:"productos-similares-container",children:e.jsx("div",{className:"productos-similares-lista",children:A.map(M=>e.jsxs("div",{className:"producto-similar",onClick:()=>d(`/productos/${M.id}`),children:[e.jsx(O,{imagenes:M.imagenes,alt:M.nombre,className:"d-block w-100"}),e.jsx("p",{children:M.nombre})]},M.id))})})]});return e.jsxs("div",{className:"product-detail-wrapper",children:[e.jsxs("div",{className:"parent-ProductDetail",children:[e.jsx("div",{className:"product-img",children:e.jsxs("div",{id:"carouselExampleIndicators",className:"carousel slide w-100","data-bs-ride":"carousel",children:[e.jsx("div",{className:"carousel-indicators",children:b.map((C,A)=>e.jsx("button",{type:"button","data-bs-target":"#carouselExampleIndicators","data-bs-slide-to":A,className:A===0?"active":"","aria-current":A===0?"true":void 0,"aria-label":`Slide ${A+1}`},A))}),e.jsx("div",{className:"carousel-inner",children:b.map((C,A)=>e.jsx("div",{className:`carousel-item ${A===0?"active":""}`,children:e.jsx("div",{onClick:()=>o(b[A]),style:{cursor:"zoom-in"},children:e.jsx(O,{imagenes:i.imagenes,index:A,alt:i.nombre,className:"d-block w-100"})})},A))}),b.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"carousel-control-prev",type:"button","data-bs-target":"#carouselExampleIndicators","data-bs-slide":"prev",children:[e.jsx("span",{className:"carousel-control-prev-icon","aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:"Previous"})]}),e.jsxs("button",{className:"carousel-control-next",type:"button","data-bs-target":"#carouselExampleIndicators","data-bs-slide":"next",children:[e.jsx("span",{className:"carousel-control-next-icon","aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:"Next"})]})]})]})}),e.jsxs("div",{className:"product-info",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Nombre:"})," ",i.nombre]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Descripción:"})," ",i.descripcion||"No hay descripción disponible."]}),e.jsx("p",{children:e.jsx("strong",{children:"Evento:"})}),(S=i.festividades)!=null&&S.length?e.jsx("ul",{className:"festividades-list",children:i.festividades.map((C,A)=>e.jsx("li",{children:N(C)},A))}):e.jsx("p",{children:"Evento no disponible"}),e.jsx("p",{children:e.jsx("strong",{children:"Etiquetas:"})}),e.jsx("ul",{className:"product-prendas",children:($=i.etiquetas)!=null&&$.length?i.etiquetas.map(C=>e.jsx("li",{children:C.nombre},C.id)):e.jsx("li",{children:"No hay etiquetas disponibles."})})]})]}),e.jsx("div",{className:"product-mapa",children:e.jsx(ue,{})}),e.jsxs("div",{className:"product-related",children:[z("Disfraces similares por nombre",E),z("Disfraces con las mismas etiquetas",L),z("Disfraces de los mismos eventos",w),z("Disfraces del mismo mes",D)]}),l&&e.jsxs("div",{className:"zoom-modal",onClick:()=>o(null),children:[e.jsx("img",{src:l,alt:"Zoom",className:"zoomed-img"}),e.jsx("button",{className:"close-btn",onClick:()=>o(null),children:"\\u00d7"})]})]})},Y=({children:s,tipo:a})=>{const c=a==="success"?"success":"error",d=a==="success"?Ne:we;return e.jsxs("div",{className:`mensaje-container ${c}`,children:[e.jsx(T,{icon:d,className:"mensaje-icon"}),e.jsx("div",{className:"mensaje-text",children:e.jsx("p",{children:s})})]})},Re=()=>{const[s,a]=n.useState({email:"",password:"",tipoUsuario:"usuario"}),[c,d]=n.useState({}),l=R(),o=j=>{a({...s,[j.target.name]:j.target.value})},i=async j=>{var m,t;j.preventDefault();try{const r=s.tipoUsuario==="admin"||s.tipoUsuario==="moderador"?"https://backend-mywf.onrender.com/api/admin/login":"https://backend-mywf.onrender.com/api/usuario/login",u=await P.post(r,s);if(u!=null&&u.data)d({respuesta:u.data.msg,tipo:!0}),u.data.token&&(localStorage.setItem("token",u.data.token),localStorage.setItem("tipoUsuario",u.data.rol),console.log("Rol guardado en localStorage:",u.data.rol),u.data.rol==="admin"||u.data.rol==="moderador"||u.data.rol==="usuario"?l("/"):d({respuesta:"Rol desconocido",tipo:!1})),a({email:"",password:"",tipoUsuario:"usuario"});else throw new Error("Respuesta inesperada del servidor")}catch(r){const u=((t=(m=r.response)==null?void 0:m.data)==null?void 0:t.msg)||"Error al iniciar sesión";d({respuesta:u,tipo:!1}),console.error("Error:",r.message)}};return e.jsxs("div",{className:"login-body",children:[e.jsx(I,{className:"brand",to:"/",children:e.jsxs("div",{className:"brand-content",children:[e.jsx("img",{src:"public/logo.png",alt:"Logo Megadisfraz",className:"header-logo-img"}),e.jsx("span",{className:"brand-text",children:"Megadisfraz"})]})}),e.jsxs("div",{className:"login-wrapper",children:[e.jsx("h2",{className:"text-center mb-4",children:"Iniciar sesión"}),e.jsxs("form",{id:"login-form",onSubmit:i,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Correo electrónico:"}),e.jsx("input",{type:"email",className:"form-control",id:"email",name:"email",value:s.email,onChange:o,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Contraseña:"}),e.jsx("input",{type:"password",className:"form-control",id:"password",name:"password",value:s.password,onChange:o,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tipo de usuario:"}),e.jsxs("select",{name:"tipoUsuario",className:"form-control",onChange:o,value:s.tipoUsuario,children:[e.jsx("option",{value:"usuario",children:"Usuario"}),e.jsx("option",{value:"admin",children:"Administrador"}),e.jsx("option",{value:"moderador",children:"Moderador"})]})]}),e.jsx("p",{className:"forgot-password",children:e.jsx(I,{to:"/forgot/id",className:"forgot-link",children:"¿Olvidaste tu contraseña?"})}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Iniciar sesión"}),e.jsxs("p",{className:"text-center mt-3",children:["¿No tienes una cuenta?"," ",e.jsx(I,{to:"/register",className:"register-link",children:"Regístrate"})]})]}),c.respuesta&&e.jsx(Y,{tipo:c.tipo?"success":"error",children:c.respuesta})]})]})},Oe=()=>{const[s,a]=n.useState({nombre:"",apellido:"",email:"",password:""}),[c,d]=n.useState({respuesta:"",tipo:""}),l=R(),o=j=>{a({...s,[j.target.name]:j.target.value})},i=async j=>{j.preventDefault();const m=/^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$/;if(!s.nombre.trim()||!s.apellido.trim()||!s.email.trim()||!s.password.trim()){d({respuesta:"Todos los campos son obligatorios.",tipo:"error"});return}if(!m.test(s.nombre)||!m.test(s.apellido)){d({respuesta:"El nombre y apellido solo pueden contener letras y espacios.",tipo:"error"});return}try{const r=await P.post("https://backend-mywf.onrender.com/api/usuario/registro",s);r&&r.data?(d({respuesta:r.data.msg,tipo:"success"}),setTimeout(()=>{d({respuesta:"",tipo:""}),l("/login")},3e3),a({nombre:"",apellido:"",email:"",password:""})):d({respuesta:"Algo salió mal",tipo:"error"})}catch(t){const r=t.response&&t.response.data?t.response.data.msg:"Error al registrar";d({respuesta:r,tipo:"error"})}};return e.jsxs("div",{className:"login-body",children:[e.jsx(I,{className:"brand",to:"/",children:e.jsxs("div",{className:"brand-content",children:[e.jsx("img",{src:"public/logo.png",alt:"Logo Megadisfraz",className:"header-logo-img"}),e.jsx("span",{className:"brand-text",children:"Megadisfraz"})]})}),e.jsxs("div",{className:"login-wrapper",children:[e.jsx("h2",{className:"text-center mb-4",children:"Registro"}),e.jsxs("form",{id:"login-form",onSubmit:i,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombre",children:"Nombre:"}),e.jsx("input",{type:"text",className:"form-control",id:"nombre",name:"nombre",value:s.nombre,onChange:o})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"apellido",children:"Apellido:"}),e.jsx("input",{type:"text",className:"form-control",id:"apellido",name:"apellido",value:s.apellido,onChange:o})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Correo Electrónico:"}),e.jsx("input",{type:"email",className:"form-control",id:"email",name:"email",value:s.email,onChange:o})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Contraseña:"}),e.jsx("input",{type:"password",className:"form-control",id:"password",name:"password",value:s.password,onChange:o})]}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Registrarse"}),e.jsxs("p",{className:"text-center mt-3",children:["¿Ya tienes una cuenta?"," ",e.jsx(I,{to:"/login",className:"login-link",children:"Inicia Sesión"})]})]}),c.respuesta&&e.jsx(Y,{tipo:c.tipo,children:c.respuesta})]})]})},Je=()=>{const{token:s}=K(),[a,c]=n.useState({respuesta:"",tipo:null});return n.useEffect(()=>{(async()=>{var l,o;try{const i=`https://backend-mywf.onrender.com/api/usuario/confirmar/${s}`,j=await P.get(i);c({respuesta:j.data.msg,tipo:"success"})}catch(i){c({respuesta:((o=(l=i.response)==null?void 0:l.data)==null?void 0:o.msg)||"Error al confirmar cuenta",tipo:"error"})}})()},[s]),e.jsxs("div",{className:"login-body",children:[e.jsx(I,{className:"brand",to:"/",children:e.jsxs("div",{className:"brand-content",children:[e.jsx("img",{src:"public/logo.png",alt:"Logo Megadisfraz",className:"header-logo-img"}),e.jsx("span",{className:"brand-text",children:"Megadisfraz"})]})}),e.jsxs("div",{className:"login-wrapper",children:[e.jsx("h2",{className:"text-center mb-4",children:"Confirmación de Cuenta"}),a.respuesta&&e.jsx(Y,{tipo:a.tipo,children:a.respuesta}),e.jsx("div",{className:"confirmar-circle",children:e.jsx(T,{icon:ye,className:"confirmar-icon"})}),e.jsx("p",{className:"text-center confirmar-texto-gracias",children:"¡Gracias por confirmar tu cuenta!"}),e.jsx("p",{className:"text-center confirmar-texto-iniciar",children:"Ahora puedes iniciar sesión."}),e.jsx(I,{to:"/login",className:"confirmar-link",children:"Iniciar Sesión"})]})]})},_e=()=>{const[s,a]=n.useState({}),[c,d]=n.useState({email:"",tipoUsuario:"usuario"}),l=i=>{d({...c,[i.target.name]:i.target.value})},o=async i=>{var j,m;i.preventDefault();try{const t=c.tipoUsuario==="admin"?"https://backend-mywf.onrender.com/api/admin/recuperar-password":"https://backend-mywf.onrender.com/api/usuario/recuperar-password",r=await P.post(t,{email:c.email});a({respuesta:r.data.msg,tipo:"success"}),d({email:"",tipoUsuario:"usuario"})}catch(t){a({respuesta:((m=(j=t.response)==null?void 0:j.data)==null?void 0:m.msg)||"Error al recuperar contraseña",tipo:"error"})}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"login-body",children:[e.jsx(I,{className:"brand",to:"/",children:e.jsxs("div",{className:"brand-content",children:[e.jsx("img",{src:"/logo.png",alt:"Logo Megadisfraz",className:"header-logo-img"}),e.jsx("span",{className:"brand-text",children:"Megadisfraz"})]})}),e.jsxs("div",{className:"login-wrapper",children:[s.respuesta&&e.jsx(Y,{tipo:s.tipo,children:s.respuesta}),e.jsx("h1",{className:"text-center mb-4",children:"¡Olvidaste tu contraseña!"}),e.jsx("h3",{className:"text-center mb-4",children:"No te preocupes, ingresa tu correo"}),e.jsxs("form",{onSubmit:o,children:[e.jsxs("div",{className:"login-form-group",children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold",children:"Email"}),e.jsx("input",{type:"email",placeholder:"Enter your email",className:"form-control",name:"email",value:c.email,onChange:l})]}),e.jsxs("div",{className:"login-form-group",children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold",children:"Tipo de Usuario"}),e.jsxs("select",{className:"form-control",name:"tipoUsuario",value:c.tipoUsuario,onChange:l,children:[e.jsx("option",{value:"usuario",children:"Usuario"}),e.jsx("option",{value:"admin",children:"Administrador"})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Enviar Correo"})})]}),e.jsxs("div",{className:"text-center mt-3",children:[e.jsx("p",{children:"Si la recuerdas"}),e.jsx(I,{to:"/login",className:"register-link",children:"Login"})]})]})]}),e.jsx("div",{className:"forgot-background"})]})},He=()=>{const{token:s}=K(),a=R(),[c,d]=n.useState(!1),[l,o]=n.useState({password:"",confirmpassword:""}),i=m=>{o({...l,[m.target.name]:m.target.value||""})},j=async m=>{m.preventDefault();try{const t=`https://backend-mywf.onrender.com/api/usuario/nuevo-password/${s}`,r=await P.post(t,l);o({password:"",confirmpassword:""}),G.success(r.data.msg),setTimeout(()=>{a("/login")},3e3)}catch(t){G.error(t.response.data.msg)}};return n.useEffect(()=>{(async()=>{try{const t=`https://backend-mywf.onrender.com/api/usuario/recuperar-password/${s}`,r=await P.get(t);d(!0),G.success(r.data.msg)}catch(t){G.error(t.response.data.msg)}})()},[s]),e.jsxs("div",{className:"login-body",children:[e.jsx(I,{className:"brand",to:"/",children:e.jsxs("div",{className:"brand-content",children:[e.jsx("img",{src:"public/logo.png",alt:"Logo Megadisfraz",className:"header-logo-img"}),e.jsx("span",{className:"brand-text",children:"Megadisfraz"})]})}),e.jsxs("div",{className:"login-wrapper",children:[e.jsx(Ee,{}),e.jsx("h1",{className:"text-center mb-4 text-3xl font-semibold uppercase text-gray-500",children:"Bienvenido Otra Vez"}),e.jsx("small",{className:"text-center text-gray-400 my-4 block text-sm",children:"Por favor ingresa los detalles"}),c&&e.jsxs("form",{className:"w-full",onSubmit:j,children:[e.jsxs("div",{className:"login-form-group",children:[e.jsx("label",{className:"mb-2 block text-sm font-semibold",children:"Password"}),e.jsx("input",{type:"password",placeholder:"Enter your password",className:"form-control",name:"password",value:l.password,onChange:i}),e.jsx("label",{className:"mb-2 block text-sm font-semibold",children:"Confirm Password"}),e.jsx("input",{type:"password",placeholder:"Repeat your password",className:"form-control",name:"confirmpassword",value:l.confirmpassword,onChange:i})]}),e.jsx("div",{className:"mb-3",children:e.jsx("button",{className:"btn btn-primary",children:"Enviar"})})]})]})]})},Ge=()=>{const s=R(),{auth:a,obtenerPerfil:c,actualizarPerfil:d,actualizarPassword:l}=n.useContext(he),[o,i]=n.useState({passwordactual:"",password:"",confirmpassword:""}),[j,m]=n.useState(""),[t,r]=n.useState(""),[u,N]=n.useState(""),v=a==null?void 0:a.rol;n.useEffect(()=>{const f=localStorage.getItem("token");f?c(f).then(p=>{r(p.nombre),N(p.apellido)}).catch(()=>{m("Error al cargar el perfil.")}):s("/")},[s]);const b=()=>{localStorage.removeItem("token"),localStorage.removeItem("tipoUsuario"),s("/")},g=f=>{i({...o,[f.target.name]:f.target.value})},x=async f=>{f.preventDefault();const p=/^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$/;if(!t.trim()||!u.trim()){m("El nombre y apellido no pueden estar vacíos.");return}if(!p.test(t)||!p.test(u)){m("El nombre y apellido solo pueden contener letras y espacios.");return}try{await d(a.usuario._id,{nombre:t,apellido:u}),m("Perfil actualizado con éxito."),setTimeout(()=>{s("/perfil")},1e3)}catch{m("Error al actualizar el perfil.")}},h=async f=>{if(f.preventDefault(),!o.passwordactual||!o.password||!o.confirmpassword){m("Todos los campos de contraseña son obligatorios.");return}if(o.password!==o.confirmpassword){m("Las contraseñas no coinciden.");return}try{await l({passwordactual:o.passwordactual,passwordnuevo:o.password}),m("Contraseña actualizada correctamente."),i({passwordactual:"",password:"",confirmpassword:""})}catch{m("Error al actualizar la contraseña.")}};return e.jsx("div",{className:"profile-container",children:e.jsxs("div",{className:"profile-wrapper",children:[e.jsx("h4",{className:"mb-4 text-center",children:v==="admin"?"Perfil de Administrador":"Perfil de Usuario"}),j&&e.jsx("div",{className:`alert ${j.includes("Error")?"alert-danger":"alert-success"}`,children:j}),a.usuario?e.jsxs("table",{className:"profile-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{class:"hidden-on-mobile",children:"ID de Usuario"}),e.jsx("th",{children:"Correo Electrónico"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Apellido"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{class:"hidden-on-mobile",children:a.usuario._id}),e.jsx("td",{children:a.usuario.email}),e.jsx("td",{children:a.usuario.nombre}),e.jsx("td",{children:a.usuario.apellido})]})})]}):e.jsx("p",{children:"Cargando..."}),e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Nuevo Nombre"}),e.jsx("input",{type:"text",className:"profile-input",value:t,onChange:f=>r(f.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Nuevo Apellido"}),e.jsx("input",{type:"text",className:"profile-input",value:u,onChange:f=>N(f.target.value)})]}),e.jsx("button",{type:"submit",className:"btn btn-success profile-button",children:"Actualizar Perfil"})]}),e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Contraseña Actual"}),e.jsx("input",{type:"password",placeholder:"Ingrese su contraseña actual",className:"profile-input",name:"passwordactual",value:o.passwordactual,onChange:g})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Nueva Contraseña"}),e.jsx("input",{type:"password",placeholder:"Ingrese su nueva contraseña",className:"profile-input",name:"password",value:o.password,onChange:g})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Confirmar Contraseña"}),e.jsx("input",{type:"password",placeholder:"Repita su nueva contraseña",className:"profile-input",name:"confirmpassword",value:o.confirmpassword,onChange:g})]}),e.jsx("button",{type:"submit",className:"btn btn-success profile-button",children:"Actualizar Contraseña"})]}),e.jsx("div",{className:"d-flex justify-content-between mt-3",children:e.jsx("button",{type:"button",className:"btn btn-danger profile-button",onClick:b,children:"Cerrar Sesión"})})]})})},Ye=()=>e.jsxs("div",{className:"not-found-container",children:[e.jsx("img",{src:"public/logo.png",alt:"Logo Megadisfraz",className:"header-logo-img"}),e.jsx("span",{className:"brand-text",children:"Megadisfraz"}),e.jsx("div",{className:"not-found-icon-wrapper",children:e.jsx(T,{icon:Ce,className:"not-found-icon"})}),e.jsx("div",{className:"not-found-content-wrapper",children:e.jsxs("div",{className:"not-found-content",children:[e.jsx("p",{className:"not-found-title",children:"Pagina no encontrada"}),e.jsx("p",{className:"not-found-text",children:"Lo sentimos, la pagina que buscas no se puedo encontrar"})]})})]}),We=()=>{const s=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],[a,c]=n.useState({mes:"",dia:"",nombre:"",descripcion:""}),[d,l]=n.useState([]),o=m=>{const t=["Abril","Junio","Septiembre","Noviembre"];return m==="Febrero"?Array.from({length:29},(r,u)=>u+1):t.includes(m)?Array.from({length:30},(r,u)=>u+1):Array.from({length:31},(r,u)=>u+1)};n.useEffect(()=>{a.mes&&(l(o(a.mes)),c(m=>({...m,dia:""})))},[a.mes]);const i=m=>{const{name:t,value:r}=m.target;c({...a,[t]:r})},j=async m=>{m.preventDefault();try{const t=await fetch("https://backend-mywf.onrender.com/api/festividad/crear",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({...a,dia:parseInt(a.dia,10)})});if(!t.ok)throw new Error("Error al crear el evento");await t.json(),alert("✅ Evento creado exitosamente")}catch{alert("❌ Hubo un problema al crear el evento")}};return e.jsxs("div",{className:"form-container",children:[e.jsx("h2",{className:"tittle-crearev",children:"Crear Eventos"}),e.jsxs("form",{onSubmit:j,className:"form-content",children:[e.jsxs("div",{className:"form-group1",children:[e.jsx("label",{htmlFor:"mes",children:"Mes:"}),e.jsxs("select",{id:"mes",name:"mes",className:"form-input3",value:a.mes,onChange:i,required:!0,children:[e.jsx("option",{value:"",children:"-- Selecciona un mes --"}),s.map((m,t)=>e.jsx("option",{value:m,children:m},t))]})]}),e.jsxs("div",{className:"form-group1",children:[e.jsx("label",{htmlFor:"dia",children:"Día:"}),e.jsxs("select",{id:"dia",name:"dia",className:"form-input3",value:a.dia,onChange:i,required:!0,disabled:!a.mes,children:[e.jsx("option",{value:"",children:"-- Selecciona un día --"}),d.map(m=>e.jsx("option",{value:m.toString(),children:m},m))]})]}),e.jsxs("div",{className:"form-group1",children:[e.jsx("label",{htmlFor:"nombre",children:"Nombre del evento o festividad:"}),e.jsx("input",{type:"text",id:"nombre",name:"nombre",className:"form-input3",value:a.nombre,onChange:i,required:!0})]}),e.jsxs("div",{className:"form-group1",children:[e.jsx("label",{htmlFor:"descripcion",children:"Descripción de la festividad:"}),e.jsx("textarea",{id:"descripcion",name:"descripcion",className:"form-input3",value:a.descripcion,onChange:i,required:!0})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Crear"})]})]})},Qe=()=>{const s=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],[a,c]=n.useState([]),[d,l]=n.useState([]),[o,i]=n.useState({mes:"",dia:"",nombre:"",descripcion:""}),[j,m]=n.useState([]),[t,r]=n.useState(!1),[u,N]=n.useState(null),[v,b]=n.useState("");n.useEffect(()=>{(async()=>{try{const q=await(await fetch("https://backend-mywf.onrender.com/api/festividad/festividades",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();c(q),l(q)}catch(E){console.error("Error al cargar eventos:",E),alert("Error al cargar eventos")}})()},[]),n.useEffect(()=>{if(v.trim()==="")l(a);else{const p=a.filter(E=>E.nombre.toLowerCase().includes(v.toLowerCase())||E.mes.toLowerCase().includes(v.toLowerCase())||E.dia.toString().includes(v));l(p)}},[v,a]),n.useEffect(()=>{if(o.mes){const p=o.mes==="Febrero"?Array.from({length:29},(E,q)=>q+1):["Abril","Junio","Septiembre","Noviembre"].includes(o.mes)?Array.from({length:30},(E,q)=>q+1):Array.from({length:31},(E,q)=>q+1);m(p),i(E=>({...E,dia:""}))}},[o.mes]);const g=p=>{const E=a.find(q=>q.id===p);E&&(i(E),N(p),r(!0))},x=async p=>{if(confirm("¿Estás seguro de eliminar este evento?"))try{if(!(await fetch(`https://backend-mywf.onrender.com/api/festividad/eliminar/${p}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok)throw new Error;alert("✅ Evento eliminado");const q=a.filter(L=>L.id!==p);c(q),l(q)}catch{alert("❌ Error al eliminar evento")}},h=p=>{const{name:E,value:q}=p.target;i(L=>({...L,[E]:q}))},f=async p=>{p.preventDefault();try{if(!(await fetch(`https://backend-mywf.onrender.com/api/festividad/actualizar/${u}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({...o,dia:parseInt(o.dia,10)})})).ok)throw new Error;alert("✅ Evento actualizado correctamente");const q=a.map(L=>L.id===u?{...L,...o}:L);c(q),l(q),r(!1),N(null)}catch{alert("❌ Error al actualizar el evento")}};return e.jsx("div",{className:"form-container",children:t?e.jsxs("form",{onSubmit:f,className:"form-content",children:[e.jsx("h2",{className:"admin-title",children:"Editar Festividad"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombre",children:"Nombre del evento:"}),e.jsx("input",{type:"text",id:"nombre",name:"nombre",className:"form-input",value:o.nombre,onChange:h,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"mes",children:"Mes:"}),e.jsxs("select",{id:"mes",name:"mes",className:"form-input",value:o.mes,onChange:h,required:!0,children:[e.jsx("option",{value:"",children:"-- Selecciona un mes --"}),s.map((p,E)=>e.jsx("option",{value:p,children:p},E))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"dia",children:"Día:"}),e.jsxs("select",{id:"dia",name:"dia",className:"form-input",value:o.dia,onChange:h,disabled:!o.mes,required:!0,children:[e.jsx("option",{value:"",children:"-- Selecciona un día --"}),j.map(p=>e.jsx("option",{value:p,children:p},p))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"descripcion",children:"Descripción:"}),e.jsx("textarea",{id:"descripcion",name:"descripcion",className:"form-input",value:o.descripcion,onChange:h,required:!0,maxLength:250}),e.jsxs("p",{className:o.descripcion.length>=250?"text-error":"",children:[o.descripcion.length," / 250 caracteres"]})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Guardar Cambios"}),e.jsx("button",{type:"button",className:"cancel-button",onClick:()=>r(!1),children:"Cancelar"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"admin-title",children:"Lista de Festividades"}),e.jsxs("div",{className:"form-content",children:[e.jsx("label",{htmlFor:"busqueda",children:"Buscar por Nombre, Mes o Día:"}),e.jsx("input",{type:"text",id:"busqueda",name:"busqueda",className:"form-input",value:v,onChange:p=>b(p.target.value),placeholder:"Ingrese un nombre, mes o día"})]}),e.jsx("ul",{className:"disfraz-list",children:d.map(p=>e.jsxs("li",{className:"disfraz-item",children:[e.jsxs("div",{className:"disfraz-info",children:[e.jsx("strong",{children:p.nombre})," - ",p.mes,"/",p.dia,e.jsx("br",{}),e.jsx("small",{children:p.descripcion})]}),e.jsxs("div",{className:"disfraz-actions",children:[e.jsx("button",{className:"edit-button2",onClick:()=>g(p.id),children:"Actualizar"}),e.jsx("button",{className:"delete-button2",onClick:()=>x(p.id),children:"Eliminar"})]})]},p.id))})]})})},Ze=()=>{const[s,a]=n.useState(null);return e.jsxs("div",{className:"admin-container",children:[e.jsx("h1",{className:"admin-title",children:"Gestión de Eventos"}),e.jsxs("div",{className:"admin-buttons-container",children:[e.jsx("button",{className:"admin-button button-crear",onClick:()=>a("crear"),children:"Crear Evento"}),e.jsx("button",{className:"admin-button button-actualizar",onClick:()=>a("editar"),children:"Editar Evento"})]}),e.jsxs("div",{className:"admin-module-container",style:{marginTop:"20px"},children:[s==="crear"&&e.jsx(We,{}),s==="editar"&&e.jsx(Qe,{})]})]})},Xe=()=>{const s=ie(),a=R(),{disfraces:c=[]}=n.useContext(_),[d,l]=n.useState(""),[o,i]=n.useState(""),[j,m]=n.useState(""),[t,r]=n.useState(""),u=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],N=h=>h?h.replace(/\|/g,"").trim():"";n.useEffect(()=>{const h=new URLSearchParams(s.search);l(h.get("query")||""),i(N(h.get("month")||"")),m(h.get("etiqueta")||""),r(h.get("event")||"")},[s]);const v=c.filter(h=>{var L,y,w,k;const f=d.toLowerCase(),p=o.toLowerCase(),E=j.toLowerCase(),q=t.toLowerCase();return(!d||h.nombre.toLowerCase().includes(f)||((L=h.descripcion)==null?void 0:L.toLowerCase().includes(f)))&&(!o||((y=h.festividades)==null?void 0:y.some(D=>D.mes.toLowerCase()===p)))&&(!j||((w=h.etiquetas)==null?void 0:w.some(D=>D.nombre.toLowerCase()===E)))&&(!t||((k=h.festividades)==null?void 0:k.some(D=>D.nombre.toLowerCase().includes(q))))}),g=(h=>{if(!h.length)return[];const f=u[new Date().getMonth()],p=u.indexOf(f),E=[...u.slice(p),...u.slice(0,p)].reverse();return[...h].sort((q,L)=>{const y=w=>{var D;let k=-1;return(D=w.festividades)==null||D.forEach(z=>{const S=E.indexOf(z.mes);S>k&&(k=S)}),k};return y(L)-y(q)})})(v),x=h=>a(`/productos/${h.id}`);return e.jsx("div",{className:"searches-container",children:e.jsxs("section",{className:"filtered-disfraces",children:[e.jsxs("h2",{className:"filtered-title",children:[d&&`Resultados para "${d}" `,o&&` Disfraces de ${o} `,j&&` Etiqueta: ${j} `,t&&` Evento: ${t}`]}),e.jsx("div",{className:"filtered-container",children:g.length?g.map(h=>{var f;return e.jsxs(Z,{className:"filtered-card",onClick:()=>x(h),children:[e.jsx(O,{imagenes:h.imagenes,alt:h.nombre,className:"filtered-image"}),e.jsxs(X,{children:[e.jsx("p",{children:h.nombre}),((f=h.festividades)==null?void 0:f.length)>0&&e.jsxs("small",{children:["Festividades: ",h.festividades.map(p=>p.mes).join(", ")]})]})]},h.id)}):e.jsx("p",{className:"no-disfraces",children:"No se encontraron disfraces con los filtros aplicados"})})]})})},Ke=()=>{const[s,a]=n.useState({nombre:"",etiquetas:[],festividades:[],descripcion:"",imagenes:[]}),[c,d]=n.useState([]),[l,o]=n.useState([]),[i,j]=n.useState(!0),[m,t]=n.useState(null),[r,u]=n.useState(!1),N=y=>{const w=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];return[...y].sort((k,D)=>{const z=w.indexOf(k.mes),S=w.indexOf(D.mes);return z!==S?z-S:k.dia-D.dia})},v=y=>[...y].sort((w,k)=>w.nombre.localeCompare(k.nombre));n.useEffect(()=>{(async()=>{try{const[w,k]=await Promise.all([fetch("https://backend-mywf.onrender.com/api/festividad/festividades",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),fetch("https://backend-mywf.onrender.com/api/etiqueta/listar",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})]);if(!w.ok||!k.ok)throw new Error("Error al cargar datos iniciales");const[D,z]=await Promise.all([w.json(),k.json()]);d(N(D||[])),o(v(z||[])),j(!1)}catch(w){console.error("Error al cargar datos:",w),t("Hubo un problema al cargar los datos necesarios"),j(!1)}})()},[]);const b=y=>{const{name:w,value:k}=y.target;a(D=>({...D,[w]:k}))},g=y=>{const w=parseInt(y.target.value);if(w===-1){window.location.href="/etiquetas";return}s.etiquetas.includes(w)||(s.etiquetas.length<6?a(k=>({...k,etiquetas:[...k.etiquetas,w]})):alert("❌ Máximo 6 etiquetas permitidas"))},x=y=>{a(w=>({...w,etiquetas:w.etiquetas.filter(k=>k!==y)}))},h=y=>{const w=parseInt(y.target.value);if(w===-1){window.location.href="/eventos";return}s.festividades.includes(w)||(s.festividades.length<5?a(k=>({...k,festividades:[...k.festividades,w]})):alert("❌ Máximo 5 festividades permitidas"))},f=y=>{a(w=>({...w,festividades:w.festividades.filter(k=>k!==y)}))},p=y=>{const w=Array.from(y.target.files);if(w.length+s.imagenes.length>3){alert("❌ Solo puedes subir un máximo de 3 imágenes");return}const k=w.map(D=>new Promise(z=>{const S=new FileReader;S.onloadend=()=>{z({file:D,preview:S.result})},S.readAsDataURL(D)}));Promise.all(k).then(D=>{a(z=>({...z,imagenes:[...z.imagenes,...D]}))})},E=y=>{a(w=>{const k=[...w.imagenes];return k.splice(y,1),{...w,imagenes:k}})},q=async()=>{try{const y=s.imagenes.map(async w=>{const k=new FormData;k.append("file",w.file),k.append("upload_preset","megadisfraz");const D=await fetch("https://api.cloudinary.com/v1_1/dxnnwuzrl/image/upload",{method:"POST",body:k});if(!D.ok){const z=await D.json();throw new Error(z.message||"Error al subir imagen")}return D.json()});return await Promise.all(y)}catch(y){throw console.error("Error al subir imágenes:",y),y}},L=async y=>{if(y.preventDefault(),u(!0),s.imagenes.length===0){alert("❌ Debes subir al menos una imagen"),u(!1);return}if(s.festividades.length===0){alert("❌ Debes seleccionar al menos una festividad"),u(!1);return}try{const k=(await q()).map($=>$.secure_url),D={nombre:s.nombre.trim(),descripcion:s.descripcion.trim(),festividades:s.festividades,etiquetas:s.etiquetas,imagenes:k},z=await fetch("https://backend-mywf.onrender.com/api/disfraz/registro",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(D)}),S=await z.json();if(!z.ok)throw new Error(S.msg||"Error al crear el disfraz");alert("✅ Disfraz creado exitosamente"),a({nombre:"",etiquetas:[],festividades:[],descripcion:"",imagenes:[]})}catch(w){console.error("Error completo:",w),alert(w.message||"Hubo un problema al crear el disfraz")}finally{u(!1)}};return i?e.jsxs("div",{className:"form-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Cargando datos necesarios..."})]}):m?e.jsxs("div",{className:"form-container",children:[e.jsx("p",{className:"error-message",children:m}),e.jsx("button",{className:"form-button",onClick:()=>window.location.reload(),children:"Reintentar"})]}):e.jsx("div",{className:"form-container",children:e.jsxs("form",{onSubmit:L,className:"form-content",children:[e.jsx("h2",{children:"Crear Disfraz"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombre",children:"Nombre:"}),e.jsx("input",{type:"text",id:"nombre",name:"nombre",className:"form-input",value:s.nombre,onChange:b,required:!0,maxLength:100})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"etiquetas",children:"Etiquetas (máx. 6):"}),e.jsxs("select",{id:"etiquetas",name:"etiquetas",className:"form-input1",onChange:g,value:"",children:[e.jsx("option",{value:"",children:"Seleccione una etiqueta"}),l.map(y=>e.jsx("option",{value:y.id,children:y.nombre},y.id)),e.jsx("option",{value:"-1",children:"➕ Crear nueva etiqueta"})]}),e.jsx("ul",{className:"etiquetas-list",children:s.etiquetas.map(y=>{const w=l.find(k=>k.id===y);return e.jsxs("li",{children:[(w==null?void 0:w.nombre)||"Etiqueta desconocida",e.jsx("button",{type:"button",className:"remove-button",onClick:()=>x(y),children:"X"})]},y)})}),e.jsxs("p",{className:s.etiquetas.length>=6?"text-error":"",children:[s.etiquetas.length," / 6 etiquetas seleccionadas"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"festividad",children:"Festividades (máx. 5):"}),e.jsxs("select",{id:"festividad",name:"festividad",className:"form-input1",onChange:h,value:"",children:[e.jsx("option",{value:"",children:"Seleccione una festividad"}),c.map(y=>e.jsxs("option",{value:y.id,children:[y.nombre," - ",y.mes,"/",y.dia]},y.id)),e.jsx("option",{value:"-1",children:"➕ Crear nueva festividad"})]}),e.jsx("ul",{className:"festividades-list",children:s.festividades.map(y=>{const w=c.find(k=>k.id===y);return e.jsxs("li",{children:[(w==null?void 0:w.nombre)||"Festividad desconocida",e.jsx("button",{type:"button",className:"remove-button",onClick:()=>f(y),children:"X"})]},y)})}),e.jsxs("p",{className:s.festividades.length>=5?"text-error":"",children:[s.festividades.length," / 5 festividades seleccionadas"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"descripcion",children:"Descripción (máx. 250 caracteres):"}),e.jsx("textarea",{id:"descripcion",name:"descripcion",className:"form-input1",maxLength:250,value:s.descripcion,onChange:b,required:!0}),e.jsxs("p",{className:s.descripcion.length>=250?"text-error":"",children:[s.descripcion.length," / 250 caracteres",s.descripcion.length>=250&&" (Límite alcanzado)"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Imágenes (máximo 3):"}),e.jsxs("div",{className:"image-preview-container",children:[s.imagenes.map((y,w)=>e.jsxs("div",{className:"image-box",children:[e.jsx("img",{src:y.preview,alt:`Preview ${w}`,className:"preview-img"}),e.jsx("button",{type:"button",className:"remove-button",onClick:()=>E(w),"aria-label":"Eliminar imagen",children:"X"})]},w)),s.imagenes.length<3&&e.jsxs("div",{className:"image-box upload-box",children:[e.jsxs("label",{className:"add-image-label",children:["+",e.jsx("input",{type:"file",accept:"image/*",onChange:p,hidden:!0,multiple:!0,"aria-label":"Añadir imagen"})]}),e.jsx("p",{className:"add-image-text",children:"Añadir imagen"})]})]})]}),e.jsx("button",{type:"submit",className:"form-button",disabled:r,children:r?"Creando...":"Crear Disfraz"})]})})};function Ve(s){const[a,c]=n.useState([]),[d,l]=n.useState([]),[o,i]=n.useState([]),[j,m]=n.useState([]),[t,r]=n.useState(!0),[u,N]=n.useState(null);n.useEffect(()=>{(async()=>{try{r(!0);const[x,h,f]=await Promise.all([fetch("https://backend-mywf.onrender.com/api/disfraz/listar",{headers:{Authorization:`Bearer ${s}`}}),fetch("https://backend-mywf.onrender.com/api/etiqueta/listar",{headers:{Authorization:`Bearer ${s}`}}),fetch("https://backend-mywf.onrender.com/api/festividad/festividades",{headers:{Authorization:`Bearer ${s}`}})]);if(!x.ok||!h.ok||!f.ok)throw new Error("Error al cargar listas iniciales");const[p,E,q]=await Promise.all([x.json(),h.json(),f.json()]);c(p),l(p),i(E),m(q)}catch(x){console.error("useDisfraces:",x),N(x)}finally{r(!1)}})()},[s]);const v=n.useCallback(x=>{if(!x.trim()){l(a);return}const h=x.toLowerCase();l(a.filter(f=>{var p,E;return f.nombre.toLowerCase().includes(h)||((p=f.etiquetas)==null?void 0:p.some(q=>q.nombre.toLowerCase().includes(h)))||((E=f.festividades)==null?void 0:E.some(q=>q.nombre.toLowerCase().includes(h)))}))},[a]),b=n.useCallback(async x=>{const h=await fetch(`https://backend-mywf.onrender.com/api/disfraz/detalle/${x}`,{headers:{Authorization:`Bearer ${s}`}});if(!h.ok)throw new Error(`Detalle error: ${h.status}`);const f=await h.json();return f.imagenes=V(f.imagenes),f},[s]),g=n.useCallback(async x=>{const h=await fetch(`https://backend-mywf.onrender.com/api/disfraz/eliminar/${x}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(!h.ok)throw new Error(`Eliminar error: ${h.status}`);c(f=>f.filter(p=>p.id!==x)),l(f=>f.filter(p=>p.id!==x))},[s]);return{disfraces:d,etiquetas:o,eventos:j,loading:t,error:u,filtrar:v,fetchDetalle:b,eliminar:g,orig:a}}function es({value:s,onChange:a}){return e.jsxs("div",{className:"form-content",children:[e.jsx("label",{children:"Buscar:"}),e.jsx("input",{className:"form-input",placeholder:"Nombre, etiqueta o festividad",value:s,onChange:c=>a(c.target.value)})]})}function ss({items:s,onEdit:a,onDelete:c}){return e.jsx("ul",{className:"disfraz-list",children:s.map(d=>{var l,o;return e.jsxs("li",{className:"disfraz-item",children:[e.jsxs("div",{className:"disfraz-info",children:[e.jsx("strong",{children:"Nombre:"})," ",d.nombre,e.jsx("br",{}),e.jsx("strong",{children:"Etiquetas:"})," ",(l=d.etiquetas)==null?void 0:l.map(i=>i.nombre).join(", "),e.jsx("br",{}),e.jsx("strong",{children:"Festividades:"})," ",(o=d.festividades)==null?void 0:o.map(i=>i.nombre).join(", ")]}),e.jsxs("div",{className:"disfraz-actions",children:[e.jsx("button",{className:"edit-button2",onClick:()=>a(d.id),children:"Editar"}),e.jsx("button",{className:"delete-button2",onClick:()=>c(d.id),children:"Eliminar"})]})]},d.id)})})}function as({src:s,onRemove:a}){return e.jsxs("div",{className:"image-box",children:[e.jsx("img",{src:s,alt:"",className:"preview-img"}),e.jsx("button",{type:"button",className:"remove-button",onClick:a,children:"×"})]})}function rs({data:s,etiquetas:a,eventos:c,onChange:d,onEtiquetaAdd:l,onEtiquetaRemove:o,onFestAdd:i,onFestRemove:j,onFileAdd:m,onFileRemove:t,onSubmit:r,submitting:u,onCancel:N}){return e.jsxs("div",{className:"modal-container",children:[e.jsx("h2",{className:"modal-title",children:"Editar Disfraz"}),e.jsxs("form",{onSubmit:r,className:"form-content",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombre",className:"form-label",children:"Nombre:"}),e.jsx("input",{id:"nombre",name:"nombre",className:"form-input",value:s.nombre,onChange:d,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"descripcion",className:"form-label",children:"Descripción (máx. 250):"}),e.jsx("textarea",{id:"descripcion",name:"descripcion",className:"form-input1",maxLength:250,value:s.descripcion,onChange:d}),e.jsxs("p",{className:s.descripcion.length>=250?"text-error":"form-help",children:[s.descripcion.length," / 250"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Etiquetas (máx. 6):"}),e.jsxs("select",{className:"form-input1",onChange:v=>l(+v.target.value),value:"",children:[e.jsx("option",{value:"",children:"Seleccione una etiqueta"}),a.map(v=>e.jsx("option",{value:v.id,children:v.nombre},v.id)),e.jsx("option",{value:-1,children:"➕ Crear nueva"})]}),e.jsx("ul",{className:"etiquetas-list",children:s.etiquetas.map(v=>{const b=a.find(g=>g.id===v);return e.jsxs("li",{className:"tag-item",children:[b==null?void 0:b.nombre,e.jsx("button",{type:"button",className:"remove-button",onClick:()=>o(v),children:"×"})]},v)})}),e.jsxs("p",{className:"form-help",children:[s.etiquetas.length," / 6 seleccionadas"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Festividades (máx. 5):"}),e.jsxs("select",{className:"form-input1",onChange:v=>i(+v.target.value),value:"",children:[e.jsx("option",{value:"",children:"Seleccione una festividad"}),c.map(v=>e.jsx("option",{value:v.id,children:v.nombre},v.id)),e.jsx("option",{value:-1,children:"➕ Crear nueva"})]}),e.jsx("ul",{className:"festividades-list",children:s.festividades.map(v=>{const b=c.find(g=>g.id===v);return e.jsxs("li",{className:"tag-item",children:[b==null?void 0:b.nombre,e.jsx("button",{type:"button",className:"remove-button",onClick:()=>j(v),children:"×"})]},v)})}),e.jsxs("p",{className:"form-help",children:[s.festividades.length," / 5 seleccionadas"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Imágenes (máx. 3):"}),e.jsxs("div",{className:"image-preview-container",children:[s.imagenes.map((v,b)=>e.jsx(as,{src:v.preview||v.url,onRemove:()=>t(b)},b)),s.imagenes.length<3&&e.jsxs("label",{className:"image-box upload-box",children:[e.jsx("span",{className:"add-image-label",children:"+"}),e.jsx("span",{className:"add-image-text",children:"Añadir imagen"}),e.jsx("input",{type:"file",accept:"image/*",hidden:!0,multiple:!0,onChange:m})]})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"form-button",disabled:u,children:u?"Actualizando...":"Guardar Cambios"}),e.jsx("button",{type:"button",className:"cancel-button",onClick:N,children:"Cancelar"})]})]})]})}function ts(){const s=localStorage.getItem("token"),{disfraces:a,etiquetas:c,eventos:d,loading:l,error:o,filtrar:i,fetchDetalle:j,eliminar:m}=Ve(s),[t,r]=n.useState({nombre:"",descripcion:"",etiquetas:[],festividades:[],imagenes:[]}),[u,N]=n.useState(!1),[v,b]=n.useState(null),[g,x]=n.useState(!1),h=async z=>{try{const S=await j(z);r({nombre:S.nombre,descripcion:S.descripcion||"",etiquetas:(S.etiquetas||[]).map($=>$.id),festividades:(S.festividades||[]).map($=>$.id),imagenes:S.imagenes.map($=>({url:$,preview:$}))}),b(z),N(!0)}catch{alert("Error al cargar detalles del disfraz")}},f=()=>{N(!1),r({nombre:"",descripcion:"",etiquetas:[],festividades:[],imagenes:[]}),b(null)},p=z=>{const{name:S,value:$}=z.target;r(C=>({...C,[S]:$}))},E=z=>{if(z===-1)return window.location.href="/etiquetas";r(S=>S.etiquetas.includes(z)||S.etiquetas.length>=6?S:{...S,etiquetas:[...S.etiquetas,z]})},q=z=>{r(S=>({...S,etiquetas:S.etiquetas.filter($=>$!==z)}))},L=z=>{if(z===-1)return window.location.href="/eventos";r(S=>S.festividades.includes(z)||S.festividades.length>=5?S:{...S,festividades:[...S.festividades,z]})},y=z=>{r(S=>({...S,festividades:S.festividades.filter($=>$!==z)}))},w=z=>{const $=Array.from(z.target.files).slice(0,3-t.imagenes.length).map(C=>({file:C,preview:URL.createObjectURL(C)}));r(C=>({...C,imagenes:[...C.imagenes,...$]}))},k=z=>{r(S=>({...S,imagenes:S.imagenes.filter(($,C)=>C!==z)}))},D=async z=>{z.preventDefault(),x(!0);try{const S=t.imagenes.filter(F=>F.url).map(F=>F.url),$=t.imagenes.filter(F=>F.file).map(F=>F.file);let C=[];if($.length>0){const F="megadisfraz",B="dxnnwuzrl";C=await Promise.all($.map(async H=>{const W=new FormData;return W.append("file",H),W.append("upload_preset",F),(await(await fetch(`https://api.cloudinary.com/v1_1/${B}/image/upload`,{method:"POST",body:W})).json()).secure_url}))}const A={nombre:t.nombre,descripcion:t.descripcion,etiquetas:t.etiquetas,festividades:t.festividades,imagenes:[...S,...C]};console.log("Enviando JSON:",A);const M=await fetch(`https://backend-mywf.onrender.com/api/disfraz/actualizar/${v}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(A)});if(!M.ok){const F=await M.json().catch(()=>({msg:"Error desconocido"}));throw new Error(F.msg)}alert("✅ Disfraz actualizado correctamente"),window.location.reload()}catch(S){console.error("❌ Error al actualizar disfraz:",S),alert("❌ "+S.message)}finally{x(!1)}};return l?e.jsx("div",{children:"Cargando disfraces…"}):o?e.jsxs("div",{children:["Error: ",o.message||"Desconocido"]}):e.jsx("div",{className:"form-container",children:u?e.jsx(rs,{data:t,etiquetas:c,eventos:d,onChange:p,onEtiquetaAdd:E,onEtiquetaRemove:q,onFestAdd:L,onFestRemove:y,onFileAdd:w,onFileRemove:k,onSubmit:D,submitting:g,onCancel:f}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"titlelistDis",children:"Lista de Disfraces"}),e.jsx(es,{onChange:i}),e.jsx(ss,{items:a,onEdit:h,onDelete:m})]})})}const ns=()=>{const[s,a]=n.useState(null);return e.jsxs("div",{className:"admin-container",children:[e.jsx("h1",{className:"admin-title",children:"Gestión de Disfraces"}),e.jsxs("div",{className:"admin-buttons-container",children:[e.jsx("button",{className:"admin-button button-crear",onClick:()=>a("crear"),children:"Crear Disfraz"}),e.jsx("button",{className:"admin-button button-actualizar",onClick:()=>a("editar"),children:"Editar Disfraz"})]}),e.jsxs("div",{className:"admin-module-container",style:{marginTop:"20px"},children:[s==="crear"&&e.jsx(Ke,{}),s==="editar"&&e.jsx(ts,{})]})]})},os=()=>{const[s,a]=n.useState({nombre:"",apellido:"",direccion:"",telefono:"",email:"",password:"",rol:"moderador"}),[c,d]=n.useState(""),l=i=>{const{name:j,value:m}=i.target;a({...s,[j]:m})},o=async i=>{i.preventDefault();try{const j=await fetch("https://backend-mywf.onrender.com/api/admin/crear-moderador",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(s)}),m=await j.json();if(!j.ok)throw new Error(m.msg||"Error al crear administrador");d("✅ Administrador creado correctamente"),a({nombre:"",apellido:"",direccion:"",telefono:"",email:"",password:"",rol:"moderador"})}catch(j){d(`❌ ${j.message}`)}};return e.jsx("div",{className:"form-container",children:e.jsxs("form",{onSubmit:o,className:"form-content",children:[e.jsx("h2",{children:"Crear Administrador"}),c&&e.jsx("p",{className:"mensaje",children:c}),["nombre","apellido","direccion","telefono","email","password"].map(i=>e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:i,children:[i.charAt(0).toUpperCase()+i.slice(1),":"]}),e.jsx("input",{type:i==="password"?"password":i==="email"?"email":"text",id:i,name:i,className:"form-input",value:s[i],onChange:l,required:!0})]},i)),e.jsx("button",{type:"submit",className:"form-button",children:"Crear"})]})})},is=()=>{const[s,a]=n.useState([]),[c,d]=n.useState([]),[l,o]=n.useState(null),[i,j]=n.useState({nombre:"",apellido:"",direccion:"",telefono:"",email:"",contraseña:""}),[m,t]=n.useState("");n.useEffect(()=>{(async()=>{try{const g=await fetch("https://backend-mywf.onrender.com/api/admin/listar-moderadores",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!g.ok)throw new Error("Error al obtener la lista de administradores");const x=await g.json();a(x),d(x)}catch(g){console.error("Error al cargar los administradores:",g),alert("Hubo un problema al cargar los administradores")}})()},[]),n.useEffect(()=>{if(m.trim()==="")d(s);else{const b=s.filter(g=>g.email.toLowerCase().includes(m.toLowerCase()));d(b)}},[m,s]);const r=async b=>{try{const g=await fetch(`https://backend-mywf.onrender.com/api/admin/detalle-moderador/${b}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!g.ok)throw new Error("Error al obtener los detalles del administrador");const x=await g.json();j(x),o(b)}catch(g){console.error("Error al cargar los detalles del administrador:",g),alert("Hubo un problema al cargar los detalles del administrador")}},u=async b=>{if(window.confirm("¿Estás seguro de que deseas eliminar este administrador?"))try{if(!(await fetch(`https://backend-mywf.onrender.com/api/admin/eliminar-moderador/${b}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok)throw new Error("Error al eliminar el administrador");alert("Administrador eliminado exitosamente");const h=s.filter(f=>f.id!==b);a(h),d(h),t("")}catch(x){console.error("Error al eliminar el administrador:",x),alert("Hubo un problema al eliminar el administrador")}},N=b=>{const{name:g,value:x}=b.target;j({...i,[g]:x})},v=async b=>{b.preventDefault();try{const g=await fetch(`https://backend-mywf.onrender.com/api/admin/actualizar-moderador/${l}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(i)});if(!g.ok)throw new Error("Error al actualizar el administrador");const x=await g.json();alert("Administrador actualizado exitosamente"),console.log("Administrador actualizado:",x),a(h=>h.map(f=>f.id===l?{...f,...i}:f)),d(h=>h.map(f=>f.id===l?{...f,...i}:f)),o(null)}catch(g){console.error("Error al actualizar el administrador:",g),alert("Hubo un problema al actualizar el administrador")}};return e.jsxs("div",{className:"form-container",children:[e.jsx("h2",{className:"listadmin",children:"Lista de Administradores"}),e.jsxs("div",{className:"form-content",children:[e.jsx("label",{className:"titlebusc",htmlFor:"email",children:"Buscar por Correo Electrónico:"}),e.jsx("input",{type:"email",id:"email",name:"email",className:"form-input",value:m,onChange:b=>t(b.target.value),placeholder:"Ingrese un correo electrónico"})]}),e.jsx("ul",{className:"admin-list",children:c.map(b=>e.jsxs("li",{className:"admin-item",children:[e.jsx("strong",{children:"Nombre:"})," ",b.nombre," ",b.apellido," ",e.jsx("br",{}),e.jsx("strong",{children:"Email:"})," ",b.email," ",e.jsx("br",{}),e.jsx("button",{onClick:()=>r(b.id),className:"edit-button",children:"Editar"}),e.jsx("button",{onClick:()=>u(b.id),className:"delete-button",children:"Eliminar"}),e.jsx("hr",{})]},b.id))}),l&&e.jsxs("form",{onSubmit:v,className:"form-content",children:[e.jsx("h2",{children:"Actualizar Administrador"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombre",children:"Nombre:"}),e.jsx("input",{type:"text",id:"nombre",name:"nombre",className:"form-input",value:i.nombre,onChange:N,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"apellido",children:"Apellido:"}),e.jsx("input",{type:"text",id:"apellido",name:"apellido",className:"form-input",value:i.apellido,onChange:N,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"direccion",children:"Dirección:"}),e.jsx("input",{type:"text",id:"direccion",name:"direccion",className:"form-input",value:i.direccion,onChange:N,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"telefono",children:"Teléfono:"}),e.jsx("input",{type:"tel",id:"telefono",name:"telefono",className:"form-input",value:i.telefono,onChange:N,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email:"}),e.jsx("input",{type:"email",id:"email",name:"email",className:"form-input",value:i.email,onChange:N,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"contraseña",children:"Contraseña:"}),e.jsx("input",{type:"password",id:"contraseña",name:"contraseña",className:"form-input",value:i.contraseña,onChange:N,required:!0})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Actualizar"})]})]})},ls=()=>{const[s,a]=n.useState(null);return e.jsxs("div",{className:"admin-container",children:[e.jsx("h1",{className:"admin-title",children:"Gestión de Administradores"}),e.jsxs("div",{className:"admin-buttons-container",children:[e.jsx("button",{className:"admin-button button-crear",onClick:()=>a("crear"),children:"Crear Administrador"}),e.jsx("button",{className:"admin-button button-actualizar",onClick:()=>a("actualizar"),children:"Actualizar Administrador"})]}),e.jsxs("div",{className:"admin-module-container",children:[s==="crear"&&e.jsx(os,{}),s==="actualizar"&&e.jsx(is,{})]})]})},cs=()=>{const[s,a]=n.useState({nombre:"",descripcion:""}),c=l=>{const{name:o,value:i}=l.target;a({...s,[o]:i})},d=async l=>{l.preventDefault();try{const o=await fetch("https://backend-mywf.onrender.com/api/etiqueta/crear",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(s)});if(!o.ok)throw new Error("Error al crear la etiqueta");const i=await o.json();alert("✅ Etiqueta creada exitosamente"),console.log("Etiqueta creada:",i),a({nombre:"",descripcion:""})}catch(o){console.error("Error al crear la etiqueta:",o),alert("❌ Hubo un problema al crear la etiqueta")}};return e.jsxs("div",{className:"form-container",children:[e.jsx("h2",{className:"title-crear-etiquetas",children:"Crear Etiqueta"}),e.jsxs("form",{onSubmit:d,className:"form-content",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombre",children:"Nombre:"}),e.jsx("input",{type:"text",id:"nombre",name:"nombre",className:"form-input",value:s.nombre,onChange:c,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"descripcion",children:"Descripción:"}),e.jsx("textarea",{id:"descripcion",name:"descripcion",className:"form-input",value:s.descripcion,onChange:c,required:!0})]}),e.jsx("button",{type:"submit",className:"form-button",children:"Crear"})]})]})},ds=()=>{const[s,a]=n.useState([]),[c,d]=n.useState([]),[l,o]=n.useState(""),[i,j]=n.useState(!1),[m,t]=n.useState({nombre:"",descripcion:""}),[r,u]=n.useState("");n.useEffect(()=>{(async()=>{try{const f=await(await fetch("https://backend-mywf.onrender.com/api/etiqueta/listar",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();a(f),d(f)}catch(h){console.error("Error al cargar etiquetas:",h),alert("Error al cargar etiquetas")}})()},[]),n.useEffect(()=>{if(r.trim()==="")d(s);else{const x=s.filter(h=>h.nombre.toLowerCase().includes(r.toLowerCase()));d(x)}},[r,s]);const N=x=>{const h=s.find(f=>f.id===x);h&&(o(x),t({nombre:h.nombre,descripcion:h.descripcion}),j(!0))},v=x=>{const{name:h,value:f}=x.target;t({...m,[h]:f})},b=async x=>{x.preventDefault();try{if(!(await fetch(`https://backend-mywf.onrender.com/api/etiqueta/actualizar/${l}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(m)})).ok)throw new Error;alert("✅ Etiqueta actualizada"),a(s.map(f=>f.id===l?{...f,...m}:f)),d(c.map(f=>f.id===l?{...f,...m}:f)),j(!1),o("")}catch{alert("❌ Error al actualizar etiqueta")}},g=async x=>{if(confirm("¿Eliminar esta etiqueta?"))try{if(!(await fetch(`https://backend-mywf.onrender.com/api/etiqueta/eliminar/${x}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok)throw new Error;const f=s.filter(p=>p.id!==x);a(f),d(f)}catch{alert("❌ Error al eliminar")}};return e.jsxs("div",{className:"form-container",children:[e.jsx("h2",{children:"Actualizar Etiquetas"}),i?e.jsxs("form",{onSubmit:b,className:"form-content",children:[e.jsx("input",{type:"text",name:"nombre",value:m.nombre,onChange:v,className:"form-input",required:!0}),e.jsx("textarea",{name:"descripcion",value:m.descripcion,onChange:v,className:"form-input",required:!0}),e.jsx("button",{type:"submit",className:"form-button",children:"Guardar Cambios"}),e.jsx("button",{type:"button",className:"cancel-button",onClick:()=>{j(!1),o("")},children:"Cancelar"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-content",children:[e.jsx("label",{children:"Buscar por Nombre:"}),e.jsx("input",{type:"text",className:"form-input",value:r,onChange:x=>u(x.target.value),placeholder:"Ingrese un nombre"})]}),e.jsx("ul",{className:"etiquetas-list",children:c.map(x=>e.jsxs("li",{children:[e.jsx("strong",{children:"Nombre:"})," ",x.nombre," ",e.jsx("br",{}),e.jsx("strong",{children:"Descripción:"})," ",x.descripcion,e.jsx("br",{}),e.jsx("button",{onClick:()=>N(x.id),className:"edit-button3",children:"Editar"}),e.jsx("button",{onClick:()=>g(x.id),className:"delete-button3",children:"Eliminar"}),e.jsx("hr",{})]},x.id))})]})]})},ms=()=>{const[s,a]=n.useState(null);return e.jsxs("div",{className:"admin-container",children:[e.jsx("h1",{className:"admin-title",children:"Gestión de Etiquetas"}),e.jsxs("div",{className:"admin-buttons-container",children:[e.jsx("button",{className:"admin-button button-crear",onClick:()=>a("crear"),children:"Crear Etiqueta"}),e.jsx("button",{className:"admin-button button-editar",onClick:()=>a("editar"),children:"Actualizar Etiqueta"})]}),e.jsxs("div",{className:"admin-module-container",style:{marginTop:"20px"},children:[s==="crear"&&e.jsx(cs,{}),s==="editar"&&e.jsx(ds,{})]})]})},ee=()=>{const[s,a]=n.useState(!1),[c,d]=n.useState("");return n.useEffect(()=>{const l=localStorage.getItem("token"),o=localStorage.getItem("tipoUsuario");a(!!l),d(o)},[]),s?e.jsx(de,{to:"/"}):e.jsx("main",{className:"flex justify-center content-center w-full h-screen",children:e.jsx(le,{})})},J=({children:s,allowedRoles:a})=>{const c=localStorage.getItem("token"),d=localStorage.getItem("tipoUsuario");return!c||a&&!a.includes(d)?e.jsx(de,{to:"/"}):s};function us(){return e.jsx(Ue,{children:e.jsx(Ae,{children:e.jsx(De,{children:e.jsx(Se,{children:e.jsx("div",{className:"app-container",children:e.jsx("div",{className:"main-content",children:e.jsxs(ke,{children:[e.jsxs(U,{path:"/",element:e.jsx(Le,{}),children:[e.jsx(U,{index:!0,element:e.jsx(Te,{})}),e.jsx(U,{path:"productos/:id",element:e.jsx(Be,{})}),e.jsx(U,{path:"searches",element:e.jsx(Xe,{})})," ",e.jsx(U,{path:"perfil",element:e.jsx(J,{allowedRoles:["admin","usuario","moderador"],children:e.jsx(Ge,{})})}),e.jsx(U,{path:"eventos",element:e.jsx(J,{allowedRoles:["admin","moderador"],children:e.jsx(Ze,{})})}),e.jsx(U,{path:"disfraces",element:e.jsx(J,{allowedRoles:["admin","moderador"],children:e.jsx(ns,{})})}),e.jsx(U,{path:"etiquetas",element:e.jsx(J,{allowedRoles:["admin","moderador"],children:e.jsx(ms,{})})}),e.jsx(U,{path:"administradores",element:e.jsx(J,{allowedRoles:["admin"],children:e.jsx(ls,{})})})]}),e.jsx(U,{path:"/login",element:e.jsx(ee,{}),children:e.jsx(U,{index:!0,element:e.jsx(Re,{})})}),e.jsx(U,{path:"/register",element:e.jsx(ee,{}),children:e.jsx(U,{index:!0,element:e.jsx(Oe,{})})}),e.jsx(U,{path:"/confirm/:token",element:e.jsx(Je,{})}),e.jsx(U,{path:"/forgot/id",element:e.jsx(_e,{})}),e.jsx(U,{path:"/recuperar-password/:token",element:e.jsx(He,{})}),e.jsx(U,{path:"*",element:e.jsx(Ye,{})})]})})})})})})})}ze.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(us,{})}));
